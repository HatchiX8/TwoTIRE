"use strict";(self["webpackChunknew_project"]=self["webpackChunknew_project"]||[]).push([[344],{1590:function(t,e,l){l.d(e,{Z:function(){return y}});var a=l(3396),s=l(7139),d=l(9242);const i={"aria-label":"Page navigation example"},r={class:"pagination justify-content-center"},n={class:"page-item"},o=(0,a._)("span",{"aria-hidden":"true"},"«",-1),u=[o],p=["onClick"],c={class:"page-item"},h=(0,a._)("span",{"aria-hidden":"true"},"»",-1),_=[h];function m(t,e,l,o,h,m){return(0,a.wg)(),(0,a.iD)("nav",i,[(0,a._)("ul",r,[(0,a._)("li",n,[(0,a._)("a",{class:(0,s.C_)(["page-link",{disabled:!1===l.pages.has_pre}]),href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,d.iM)((t=>m.updatePage(l.pages.current_page-1)),["prevent"]))},u,2)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(t=>((0,a.wg)(),(0,a.iD)("li",{class:(0,s.C_)(["page-item",{active:t===l.pages.current_page}]),key:t},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,d.iM)((e=>m.updatePage(t)),["prevent"])},(0,s.zw)(t),9,p)],2)))),128)),(0,a._)("li",c,[(0,a._)("a",{class:(0,s.C_)(["page-link",{disabled:!1===l.pages.has_next}]),href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,d.iM)((t=>m.updatePage(l.pages.current_page+1)),["prevent"]))},_,2)])])])}var g={props:["pages"],methods:{updatePage(t){this.$emit("emit-pages",t)}}},b=l(89);const w=(0,b.Z)(g,[["render",m]]);var y=w},9344:function(t,e,l){l.r(e),l.d(e,{default:function(){return yt}});var a=l(3396),s=l(7139),d=l(9242);const i={class:"text-end my-3 me-5"},r={class:"table mt-4"},n=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"購買時間"),(0,a._)("th",null,"Email"),(0,a._)("th",null,"購買款項"),(0,a._)("th",null,"應付金額"),(0,a._)("th",null,"是否付款"),(0,a._)("th",null,"編輯")])],-1),o=["textContent"],u={class:"list-unstyled"},p={class:"text-right"},c={class:"form-check form-switch"},h=["id","onUpdate:modelValue","onChange"],_=["for"],m={key:0},g={key:1},b={class:"btn-group"},w=["onClick"],y=["onClick"];function v(t,e,l,v,f,k){const O=(0,a.up)("LoadingPlugin"),D=(0,a.up)("OrderModal"),x=(0,a.up)("DelModal"),M=(0,a.up)("DelAll"),C=(0,a.up)("PaginationComponent");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(O,{active:f.isLoading},null,8,["active"]),(0,a._)("div",i,[(0,a._)("button",{class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=(...t)=>k.openDelAll&&k.openDelAll(...t))},"刪除所有訂單")]),(0,a._)("table",r,[n,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.orders,((e,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[f.orders.length?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,s.C_)({"text-secondary":!e.is_paid})},[(0,a._)("td",null,(0,s.zw)(t.$filters.date(e.create_at)),1),(0,a._)("td",null,[e.user?((0,a.wg)(),(0,a.iD)("span",{key:0,textContent:(0,s.zw)(e.user.email)},null,8,o)):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("ul",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,((t,e)=>((0,a.wg)(),(0,a.iD)("li",{key:e},(0,s.zw)(t.product.title)+" 數量："+(0,s.zw)(t.qty)+" "+(0,s.zw)(t.product.unit),1)))),128))])]),(0,a._)("td",p,(0,s.zw)(e.total),1),(0,a._)("td",null,[(0,a._)("div",c,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${e.id}`,"onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>k.updatePaid(e)},null,40,h),[[d.e8,e.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`paidSwitch${e.id}`},[e.is_paid?((0,a.wg)(),(0,a.iD)("span",m,"已付款")):((0,a.wg)(),(0,a.iD)("span",g,"未付款"))],8,_)])]),(0,a._)("td",null,[(0,a._)("div",b,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>k.openModal(!1,e)}," 檢視 ",8,w),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>k.openDelOrderModal(e)}," 刪除 ",8,y)])])],2)):(0,a.kq)("",!0)],64)))),128))])]),(0,a.Wm)(D,{order:f.tempOrder,ref:"OrderModal",onUpdatePaid:k.updatePaid},null,8,["order","onUpdatePaid"]),(0,a.Wm)(x,{item:f.tempOrder,ref:"delModal",onDelItem:k.delOrder},null,8,["item","onDelItem"]),(0,a.Wm)(M,{ref:"delAll",onDelAll:k.delAllOrder},null,8,["onDelAll"]),(0,a.Wm)(C,{pages:f.pagination,onEmitPages:k.getOrders},null,8,["pages","onEmitPages"])],64)}var f=l(6944);const k={class:"modal fade",id:"delAll",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},O={class:"modal-dialog",role:"document"},D={class:"modal-content border-0"},x=(0,a.uE)('<div class="modal-header bg-primary text-white"><h5 class="modal-title"><span>刪除所有</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> 是否刪除 <strong class="text-danger">&#39;所有訂單&#39;</strong> (刪除後將無法恢復)。 </div>',2),M={class:"modal-footer"},C=(0,a._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"}," 取消 ",-1);function P(t,e,l,s,d,i){return(0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("div",O,[(0,a._)("div",D,[x,(0,a._)("div",M,[C,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-all"))},"確認刪除")])])])],512)}var $=l(1339),z={data(){return{modal:{}}},mixins:[$.Z]},A=l(89);const L=(0,A.Z)(z,[["render",P]]);var Z=L;const H={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Y={class:"modal-dialog modal-xl",role:"document"},j={class:"modal-content border-0"},q=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),E={class:"modal-body"},W={class:"row"},K={class:"col-md-4"},U=(0,a._)("h3",null,"用戶資料",-1),N={class:"table"},S={key:0},I=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),V=(0,a._)("th",null,"Email",-1),B=(0,a._)("th",null,"電話",-1),F=(0,a._)("th",null,"地址",-1),G={class:"col-md-8"},J=(0,a._)("h3",null,"訂單細節",-1),Q={class:"table"},R=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),T=(0,a._)("th",null,"下單時間",-1),X=(0,a._)("th",null,"付款時間",-1),tt={key:0},et={key:1},lt=(0,a._)("th",null,"付款狀態",-1),at={key:0,class:"text-success"},st={key:1,class:"text-muted"},dt=(0,a._)("th",null,"總金額",-1),it=(0,a._)("h3",null,"選購商品",-1),rt={class:"table"},nt=(0,a._)("thead",null,[(0,a._)("tr")],-1),ot={class:"text-end"},ut={class:"modal-footer"},pt=(0,a._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"}," 取消 ",-1);function ct(t,e,l,d,i,r){return(0,a.wg)(),(0,a.iD)("div",H,[(0,a._)("div",Y,[(0,a._)("div",j,[q,(0,a._)("div",E,[(0,a._)("div",W,[(0,a._)("div",K,[U,(0,a._)("table",N,[i.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",S,[(0,a._)("tr",null,[I,(0,a._)("td",null,(0,s.zw)(i.tempOrder.user.name),1)]),(0,a._)("tr",null,[V,(0,a._)("td",null,(0,s.zw)(i.tempOrder.user.email),1)]),(0,a._)("tr",null,[B,(0,a._)("td",null,(0,s.zw)(i.tempOrder.user.tel),1)]),(0,a._)("tr",null,[F,(0,a._)("td",null,(0,s.zw)(i.tempOrder.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",G,[J,(0,a._)("table",Q,[(0,a._)("tbody",null,[(0,a._)("tr",null,[R,(0,a._)("td",null,(0,s.zw)(i.tempOrder.id),1)]),(0,a._)("tr",null,[T,(0,a._)("td",null,(0,s.zw)(t.$filters.date(i.tempOrder.create_at)),1)]),(0,a._)("tr",null,[X,(0,a._)("td",null,[i.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",tt,(0,s.zw)(t.$filters.date(i.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",et,"時間不正確"))])]),(0,a._)("tr",null,[lt,(0,a._)("td",null,[i.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",at,"已付款")):((0,a.wg)(),(0,a.iD)("span",st,"尚未付款"))])]),(0,a._)("tr",null,[dt,(0,a._)("td",null,(0,s.zw)(t.$filters.currency(i.tempOrder.total)),1)])])]),it,(0,a._)("table",rt,[nt,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.tempOrder.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("th",null,(0,s.zw)(e.product.title),1),(0,a._)("td",null,(0,s.zw)(e.qty)+" / "+(0,s.zw)(e.product.unit),1),(0,a._)("td",ot,(0,s.zw)(t.$filters.currency(e.final_total)),1)])))),128))])])])])]),(0,a._)("div",ut,[pt,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=e=>t.$emit("update-order",i.tempOrder))}," 確認 ")])])])],512)}var ht={name:"orderModal",props:{order:{type:Object,default(){return{}}}},data(){return{status:{},modal:"",tempOrder:{},isPaid:!1}},emits:["update-product"],mixins:[$.Z],inject:["emitter"],watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}}};const _t=(0,A.Z)(ht,[["render",ct]]);var mt=_t,gt=l(1590),bt={data(){return{orders:{},isNew:!1,pagination:{},isLoading:!1,tempOrder:{},currentPage:1}},components:{PaginationComponent:gt.Z,DelModal:f.Z,DelAll:Z,OrderModal:mt},methods:{getOrders(t=1){this.currentPage=t;const e=`https://vue3-course-api.hexschool.io/api/twotire-api/admin/orders?page=${t}`;this.isLoading=!0,this.$http.get(e,this.tempProduct).then((t=>{this.orders=t.data.orders,this.pagination=t.data.pagination,this.isLoading=!1}))},openModal(t,e){this.tempOrder={...e},this.isNew=!1;const l=this.$refs.OrderModal;l.showModal()},openDelOrderModal(t){this.tempOrder={...t};const e=this.$refs.delModal;e.showModal()},updatePaid(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/twotire-api/admin/order/${t.id}`,l={is_paid:t.is_paid};this.$http.put(e,{data:l}).then((t=>{this.isLoading=!1,this.$httpMessageState(t,"更新付款狀態")&&this.getOrders(this.currentPage)}))},delOrder(){const t=`https://vue3-course-api.hexschool.io/api/twotire-api/admin/order/${this.tempOrder.id}`;this.isLoading=!0,this.$http.delete(t).then((()=>{const t=this.$refs.delModal;t.hideModal(),this.getOrders(this.currentPage)}))},openDelAll(){const t=this.$refs.delAll;t.showModal()},delAllOrder(){const t="https://vue3-course-api.hexschool.io/api/twotire-api/admin/orders/all";this.isLoading=!0,this.$http.delete(t).then((()=>{const t=this.$refs.delAll;t.hideModal(),this.getOrders(this.currentPage)}))}},created(){this.getOrders()}};const wt=(0,A.Z)(bt,[["render",v]]);var yt=wt}}]);
//# sourceMappingURL=344.8904e0a6.js.map